$(document).ready(function () {
	"use strict";	
	var time_series_data, time_series_chart;

  if ( typeof JSON == 'undefined' ){
    time_series_data = $.parseJSON( time_series_json );

  } else { time_series_data = JSON.parse( time_series_json ) }

	time_series_chart = new TimeSeriesChart(
    time_series_data.data,
    time_series_data
  );

	$(".chart-ui").click(function (event) {
		event.preventDefault();
		var update_chart_url = $(this).attr('href') + ".json";
    time_series_chart.clearTotal( );
		time_series_chart.showLoading();

		$.getJSON( 
      update_chart_url, 

      function (results) {
        time_series_chart.update( results.data, results );
			  time_series_chart.hideLoading();
        // '_trackEvent' is the pageview event,
			  _gaq.push( [ '_trackPageview', update_chart_url ] );
		  }

      // ToDo Handle error here
    ).error( function ( xhr, status, error ) { time_series_chart.hideLoading(); });
	});
});
